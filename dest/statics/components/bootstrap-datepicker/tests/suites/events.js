module("Events",{setup:function(){this.input=$('<input type="text" value="31-03-2011">').appendTo("#qunit-fixture").datepicker({format:"dd-mm-yyyy"}).focus(),this.dp=this.input.data("datepicker"),this.picker=this.dp.picker},teardown:function(){this.picker.remove()}}),test("Selecting a year from decade view triggers changeYear",function(){var a,b=0;this.input.on("changeYear",function(){b++}),equal(this.dp.viewMode,0),a=this.picker.find(".datepicker-days thead th.datepicker-switch"),ok(a.is(":visible"),"View switcher is visible"),a.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(this.dp.viewMode,1),datesEqual(this.dp.viewDate,UTCDate(2011,2,31)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),a=this.picker.find(".datepicker-months thead th.datepicker-switch"),ok(a.is(":visible"),"View switcher is visible"),a.click(),ok(this.picker.find(".datepicker-years").is(":visible"),"Year picker is visible"),equal(this.dp.viewMode,2),datesEqual(this.dp.viewDate,UTCDate(2011,2,31)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),a=this.picker.find(".datepicker-years tbody span:contains(2010)"),a.click(),equal(this.dp.viewMode,1),datesEqual(this.dp.viewDate,UTCDate(2010,2,1)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),equal(b,1)}),test("Navigating forward/backward from month view triggers changeYear",function(){var a,b=0;this.input.on("changeYear",function(){b++}),equal(this.dp.viewMode,0),a=this.picker.find(".datepicker-days thead th.datepicker-switch"),ok(a.is(":visible"),"View switcher is visible"),a.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(this.dp.viewMode,1),a=this.picker.find(".datepicker-months thead th.prev"),ok(a.is(":visible"),"Prev switcher is visible"),a.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(b,1),a=this.picker.find(".datepicker-months thead th.next"),ok(a.is(":visible"),"Next switcher is visible"),a.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(b,2)}),test("Selecting a month from year view triggers changeMonth",function(){var a,b=0;this.input.on("changeMonth",function(){b++}),equal(this.dp.viewMode,0),a=this.picker.find(".datepicker-days thead th.datepicker-switch"),ok(a.is(":visible"),"View switcher is visible"),a.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(this.dp.viewMode,1),datesEqual(this.dp.viewDate,UTCDate(2011,2,31)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),a=this.picker.find(".datepicker-months tbody span:contains(Apr)"),a.click(),equal(this.dp.viewMode,0),datesEqual(this.dp.viewDate,UTCDate(2011,3,1)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),equal(b,1)}),test("Navigating forward/backward from month view triggers changeMonth",function(){var a,b=0;this.input.on("changeMonth",function(){b++}),equal(this.dp.viewMode,0),a=this.picker.find(".datepicker-days thead th.prev"),ok(a.is(":visible"),"Prev switcher is visible"),a.click(),ok(this.picker.find(".datepicker-days").is(":visible"),"Day picker is visible"),equal(b,1),a=this.picker.find(".datepicker-days thead th.next"),ok(a.is(":visible"),"Next switcher is visible"),a.click(),ok(this.picker.find(".datepicker-days").is(":visible"),"Day picker is visible"),equal(b,2)}),test("format() returns a formatted date string",function(){var a,b,c;this.input.on("changeDate",function(a){try{c=a.format()}catch(a){b=a}}),equal(this.dp.viewMode,0),a=this.picker.find(".datepicker-days tbody td:nth(15)"),a.click(),datesEqual(this.dp.viewDate,UTCDate(2011,2,14)),datesEqual(this.dp.dates[0],UTCDate(2011,2,14)),equal(b,void 0),equal(c,"14-03-2011")}),test("format(altformat) returns a formatted date string",function(){var a,b,c;this.input.on("changeDate",function(a){try{c=a.format("m/d/yy")}catch(a){b=a}}),equal(this.dp.viewMode,0),a=this.picker.find(".datepicker-days tbody td:nth(15)"),a.click(),datesEqual(this.dp.viewDate,UTCDate(2011,2,14)),datesEqual(this.dp.dates[0],UTCDate(2011,2,14)),equal(b,void 0),equal(c,"3/14/11")}),test("format(ix) returns a formatted date string of the ix'th date selected",function(){var a,b,c;this.dp._process_options({multidate:!0}),this.input.on("changeDate",function(a){try{c=a.format(2)}catch(a){b=a}}),a=this.picker.find(".datepicker-days tbody td:nth(7)"),equal(a.text(),"6"),a.click(),a=this.picker.find(".datepicker-days tbody td:nth(15)"),equal(a.text(),"14"),a.click(),equal(this.dp.dates.length,3),equal(b,void 0),equal(c,"14-03-2011")}),test("format(ix, altformat) returns a formatted date string",function(){var a,b,c;this.dp._process_options({multidate:!0}),this.input.on("changeDate",function(a){try{c=a.format(2,"m/d/yy")}catch(a){b=a}}),a=this.picker.find(".datepicker-days tbody td:nth(7)"),equal(a.text(),"6"),a.click(),a=this.picker.find(".datepicker-days tbody td:nth(15)"),equal(a.text(),"14"),a.click(),equal(this.dp.dates.length,3),equal(b,void 0),equal(c,"3/14/11")}),test("Clear button: triggers change and changeDate events",function(){this.input=$('<input type="text" value="31-03-2011">').appendTo("#qunit-fixture").datepicker({format:"dd-mm-yyyy",clearBtn:!0}).focus(),this.dp=this.input.data("datepicker"),this.picker=this.dp.picker;var a,b=0,c=0;this.input.on({changeDate:function(){c++},change:function(){b++}}),this.input.focus(),ok(this.picker.find(".datepicker-days").is(":visible"),"Days view visible"),ok(this.picker.find(".datepicker-days tfoot .clear").is(":visible"),"Clear button visible"),a=this.picker.find(".datepicker-days tfoot .clear"),a.click(),equal(b,1),equal(c,1)}),test("setDate: triggers change and changeDate events",function(){this.input=$('<input type="text" value="31-03-2011">').appendTo("#qunit-fixture").datepicker({format:"dd-mm-yyyy"}).focus(),this.dp=this.input.data("datepicker"),this.picker=this.dp.picker;var a=0,b=0;this.input.on({changeDate:function(){b++},change:function(){a++}}),this.input.focus(),ok(this.picker.find(".datepicker-days").is(":visible"),"Days view visible"),this.dp.setDate(new Date(2011,2,5)),equal(a,2),equal(b,1)});