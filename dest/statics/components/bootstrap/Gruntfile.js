module.exports=function(a){"use strict";a.util.linefeed="\n",RegExp.quote=function(a){return a.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")};var b=require("fs"),c=require("path"),d=require("npm-shrinkwrap"),e=require("./grunt/bs-glyphicons-data-generator.js"),f=require("./grunt/bs-lessdoc-parser.js"),g=require("./grunt/bs-raw-files-generator.js");a.initConfig({pkg:a.file.readJSON("package.json"),banner:'/*!\n * Bootstrap v<%= pkg.version %> (<%= pkg.homepage %>)\n * Copyright 2011-<%= grunt.template.today("yyyy") %> <%= pkg.author %>\n * Licensed under <%= pkg.license.type %> (<%= pkg.license.url %>)\n */\n',jqueryCheck:"if (typeof jQuery === 'undefined') { throw new Error('Bootstrap\\'s JavaScript requires jQuery') }\n\n",clean:{dist:["dist","docs/dist"]},jshint:{options:{jshintrc:"js/.jshintrc"},grunt:{options:{jshintrc:"grunt/.jshintrc"},src:["Gruntfile.js","grunt/*.js"]},src:{src:"js/*.js"},test:{options:{jshintrc:"js/tests/unit/.jshintrc"},src:"js/tests/unit/*.js"},assets:{src:["docs/assets/js/_src/*.js","docs/assets/js/*.js","!docs/assets/js/*.min.js"]}},jscs:{options:{config:"js/.jscsrc"},grunt:{src:"<%= jshint.grunt.src %>"},src:{src:"<%= jshint.src.src %>"},test:{src:"<%= jshint.test.src %>"},assets:{options:{requireCamelCaseOrUpperCaseIdentifiers:null},src:"<%= jshint.assets.src %>"}},concat:{options:{banner:"<%= banner %>\n<%= jqueryCheck %>",stripBanners:!1},bootstrap:{src:["js/transition.js","js/alert.js","js/button.js","js/carousel.js","js/collapse.js","js/dropdown.js","js/modal.js","js/tooltip.js","js/popover.js","js/scrollspy.js","js/tab.js","js/affix.js"],dest:"dist/js/<%= pkg.name %>.js"}},uglify:{options:{preserveComments:"some"},bootstrap:{src:"<%= concat.bootstrap.dest %>",dest:"dist/js/<%= pkg.name %>.min.js"},customize:{src:["docs/assets/js/_vendor/less.min.js","docs/assets/js/_vendor/jszip.min.js","docs/assets/js/_vendor/uglify.min.js","docs/assets/js/_vendor/blob.js","docs/assets/js/_vendor/filesaver.js","docs/assets/js/raw-files.min.js","docs/assets/js/_src/customizer.js"],dest:"docs/assets/js/customize.min.js"},docsJs:{src:["docs/assets/js/_vendor/holder.js","docs/assets/js/_vendor/ZeroClipboard.min.js","docs/assets/js/_src/application.js"],dest:"docs/assets/js/docs.min.js"}},qunit:{options:{inject:"js/tests/unit/phantom.js"},files:"js/tests/index.html"},less:{compileCore:{options:{strictMath:!0,sourceMap:!0,outputSourceFiles:!0,sourceMapURL:"<%= pkg.name %>.css.map",sourceMapFilename:"dist/css/<%= pkg.name %>.css.map"},files:{"dist/css/<%= pkg.name %>.css":"less/bootstrap.less"}},compileTheme:{options:{strictMath:!0,sourceMap:!0,outputSourceFiles:!0,sourceMapURL:"<%= pkg.name %>-theme.css.map",sourceMapFilename:"dist/css/<%= pkg.name %>-theme.css.map"},files:{"dist/css/<%= pkg.name %>-theme.css":"less/theme.less"}}},autoprefixer:{options:{browsers:["Android 2.3","Android >= 4","Chrome >= 20","Firefox >= 24","Explorer >= 8","iOS >= 6","Opera >= 12","Safari >= 6"]},core:{options:{map:!0},src:"dist/css/<%= pkg.name %>.css"},theme:{options:{map:!0},src:"dist/css/<%= pkg.name %>-theme.css"},docs:{src:"docs/assets/css/_src/docs.css"},examples:{expand:!0,cwd:"docs/examples/",src:["**/*.css"],dest:"docs/examples/"}},csslint:{options:{csslintrc:"less/.csslintrc"},src:["dist/css/bootstrap.css","dist/css/bootstrap-theme.css"],examples:["docs/examples/**/*.css"],docs:{options:{ids:!1,"overqualified-elements":!1},src:"docs/assets/css/_src/docs.css"}},cssmin:{options:{compatibility:"ie8",keepSpecialComments:"*",noAdvanced:!0},core:{files:{"dist/css/<%= pkg.name %>.min.css":"dist/css/<%= pkg.name %>.css","dist/css/<%= pkg.name %>-theme.min.css":"dist/css/<%= pkg.name %>-theme.css"}},docs:{src:["docs/assets/css/_src/docs.css","docs/assets/css/_src/pygments-manni.css"],dest:"docs/assets/css/docs.min.css"}},usebanner:{options:{position:"top",banner:"<%= banner %>"},files:{src:"dist/css/*.css"}},csscomb:{options:{config:"less/.csscomb.json"},dist:{expand:!0,cwd:"dist/css/",src:["*.css","!*.min.css"],dest:"dist/css/"},examples:{expand:!0,cwd:"docs/examples/",src:"**/*.css",dest:"docs/examples/"},docs:{files:{"docs/assets/css/_src/docs.css":"docs/assets/css/_src/docs.css"}}},copy:{fonts:{expand:!0,src:"fonts/*",dest:"dist/"},docs:{expand:!0,cwd:"./dist",src:["{css,js}/*.min.*","css/*.map","fonts/*"],dest:"docs/dist"}},connect:{server:{options:{port:3e3,base:"."}}},jekyll:{docs:{}},jade:{compile:{options:{pretty:!0,data:function(){var a=c.join(__dirname,"less/variables.less"),d=b.readFileSync(a,{encoding:"utf8"}),e=new f(d);return{sections:e.parseFile()}}},files:{"docs/_includes/customizer-variables.html":"docs/_jade/customizer-variables.jade","docs/_includes/nav/customize.html":"docs/_jade/customizer-nav.jade"}}},validation:{options:{charset:"utf-8",doctype:"HTML5",failHard:!0,reset:!0,relaxerror:["Bad value X-UA-Compatible for attribute http-equiv on element meta.","Element img is missing required attribute src."]},files:{src:"_gh_pages/**/*.html"}},watch:{src:{files:"<%= jshint.src.src %>",tasks:["jshint:src","qunit"]},test:{files:"<%= jshint.test.src %>",tasks:["jshint:test","qunit"]},less:{files:"less/*.less",tasks:"less"}},sed:{versionNumber:{pattern:function(){var b=a.option("oldver");return b?RegExp.quote(b):b}(),replacement:a.option("newver"),recursive:!0}},"saucelabs-qunit":{all:{options:{build:process.env.TRAVIS_JOB_ID,concurrency:10,maxRetries:3,urls:["http://127.0.0.1:3000/js/tests/index.html"],browsers:a.file.readYAML("grunt/sauce_browsers.yml")}}},exec:{npmUpdate:{command:"npm update"}}}),require("load-grunt-tasks")(a,{scope:"devDependencies"}),require("time-grunt")(a),a.registerTask("validate-html",["jekyll","validation"]);var h=function(a){return!process.env.TWBS_TEST||process.env.TWBS_TEST===a},i=function(a){return void 0===a||"0"!==a},j=[];h("core")&&(j=j.concat(["dist-css","csslint","jshint","jscs","qunit","build-customizer-html"])),h("validate-html")&&i(process.env.TWBS_DO_VALIDATOR)&&j.push("validate-html"),"undefined"!=typeof process.env.SAUCE_ACCESS_KEY&&h("sauce-js-unit")&&i(process.env.TWBS_DO_SAUCE)&&(j.push("connect"),j.push("saucelabs-qunit")),a.registerTask("test",j),a.registerTask("dist-js",["concat","uglify"]),a.registerTask("less-compile",["less:compileCore","less:compileTheme"]),a.registerTask("dist-css",["less-compile","autoprefixer","usebanner","csscomb","cssmin"]),a.registerTask("dist-docs","copy:docs"),a.registerTask("dist",["clean","dist-css","copy:fonts","dist-js","dist-docs"]),a.registerTask("default",["test","dist","build-glyphicons-data","build-customizer"]),a.registerTask("change-version-number","sed"),a.registerTask("build-glyphicons-data",function(){e.call(this,a)}),a.registerTask("build-customizer",["build-customizer-html","build-raw-files"]),a.registerTask("build-customizer-html","jade"),a.registerTask("build-raw-files","Add scripts/less files to customizer.",function(){var b=a.template.process("<%= banner %>");g(a,b)}),a.registerTask("update-shrinkwrap",["exec:npmUpdate","_update-shrinkwrap"]),a.registerTask("_update-shrinkwrap",function(){var c=this.async();d({dev:!0,dirname:__dirname},function(d){d&&a.fail.warn(d);var e="test-infra/npm-shrinkwrap.json";b.renameSync("npm-shrinkwrap.json",e),a.log.writeln("File "+e.cyan+" updated."),c()})})};